--- arch/x86/xen/smp.c
+++ arch/x86/xen/smp.c
@@ -521,7 +511,10 @@
 	native_smp_prepare_cpus(max_cpus);
 	WARN_ON(xen_smp_intr_init(0));
 
+	if (!xen_have_vector_callback)
+		return;
 	xen_init_lock_cpu(0);
+	xen_init_spinlocks();
 }
 
 static int __cpuinit xen_hvm_cpu_up(unsigned int cpu)
